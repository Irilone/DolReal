
  if (data.error) {
    log(`✗ API Error: ${data.error.message}`, 'red');
    throw new Error(`OpenAI API error: ${data.error.message}`);
  }

  const text = data.choices?.[0]?.message?.content ?? '';

  if (!text) {
    log('✗ No response text generated', 'red');
    throw new Error('OpenAI API returned no text');
  }
